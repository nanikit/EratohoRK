;────────────────────────────────────
;회화(기분 0/호의 1/지식 2/농락해라 3/위협한다 4/의상 5/합의 6/처분 7/고함친다 8/비웃는다 9/매도 66)
;────────────────────────────────────
@ACT_M0(ARG = 0)
;1이상이라면 판정을 실시하지 않는다
#DIM LCOUNT, 1

;함수 초기화
CALL ACT_M_INIT(0)

;처리 개시

LOCALS = ACT_ACTM0

CALL CHA_CRI_VAR, "기준치"
CALLFORM %LOCALS%_REFERENCE

CALL CHA_CRI_VAR, @"턴방침(%POLICY("지금")%)"
CALLFORM %LOCALS%_MENU

CALL CHA_CRI_VAR, "조교자의 소질"
CALLFORM %LOCALS%_TALENT_T

CALL CHA_CRI_VAR, "조교 대상의 소질"
CALLFORM %LOCALS%_TALENT_M

CALL CHA_CRI_VAR, "조교자의 성별 의식"
CALLFORM %LOCALS%_GENDER_T

CALL CHA_CRI_VAR, "조교 대상의 능력"
CALLFORM %LOCALS%_ABL_M

CALL CHA_CRI_VAR, "조교 대상의 쾌감"
CALLFORM %LOCALS%_PLEASURE_M

CALL CHA_CRI_VAR, "조교 대상의 반항"
CALLFORM %LOCALS%_RESISTANCE_M

CALL CHA_CRI_VAR, "조교 대상의 치정"
CALLFORM %LOCALS%_SHYNESS_M

CALL CHA_CRI_VAR, "조교 대상의 공포"
CALLFORM %LOCALS%_FEAR_M

CALL CHA_CRI_VAR, "조교 대상의 억울"
CALLFORM %LOCALS%_DEPRESSION_M

CALL CHA_CRI_VAR, "조교 대상의 반발 각인"
CALLFORM %LOCALS%_RESISTMARK_M

CALL CHA_CRI_VAR, "조교 대상의 반발 각인"
CALLFORM %LOCALS%_SEXUALINFO_M

CALL CHA_CRI_VAR, "조교자의 죄악감"
CALLFORM %LOCALS%_SIN_T

CALL CHA_CRI_VAR, "조교자의 ALI"
CALLFORM %LOCALS%_ALI_T

CALL CHA_CRI_VAR, "조교자의 이성"
CALLFORM %LOCALS%_REASON_T

CALL CHA_CRI_VAR, "조교자의 흥미"
CALLFORM %LOCALS%_INTEREST_T

CALL CHA_CRI_VAR, "조교자의 초조"
CALLFORM %LOCALS%_IRRITATION_T

CALL CHA_CRI_VAR, "조교자의 만족"
CALLFORM %LOCALS%_SATISFACTION_T

CALL CHA_CRI_VAR, @"조교자 상태(%CONDITION(TCVAR:상태변화)%)"
CALLFORM %LOCALS%_CONDITION_T

CALL CHA_CRI_VAR, "장착 도구"
CALLFORM %LOCALS%_TOOLS

CALL CHA_CRI_VAR, "미약"
CALLFORM %LOCALS%_DRAG

CALL CHA_CRI_VAR, "줄"
CALLFORM %LOCALS%_ROPE

CALL CHA_CRI_VAR, "아이마스크"
CALLFORM %LOCALS%_EYEMASK

CALL CHA_CRI_VAR, "볼개그"
CALLFORM %LOCALS%_GAG

CALL CHA_CRI_VAR, "삼각목마"
CALLFORM %LOCALS%_HORSE

CALL CHA_CRI_VAR, "야외플레이"
CALLFORM %LOCALS%_OUT

CALL CHA_CRI_VAR, "조교 대상 자위중"
CALLFORM %LOCALS%_MASTURBATION_M

CALL CHA_CRI_VAR, "조교자 자위중"
CALLFORM %LOCALS%_MASTURBATION_T

CALL CHA_CRI_VAR, "삽입 보정"
CALLFORM %LOCALS%_INSERT

CALL CHA_CRI_VAR, "조교 대상의 복장"
CALLFORM %LOCALS%_CLOTH_M

CALL CHA_CRI_VAR, "용서를빈다"
CALLFORM %LOCALS%_PLEASE_HELP

CALL CHA_CRI_VAR, "기출의화제"
CALLFORM %LOCALS%_ALREADY_TALKED

CALL CHA_CRI_VAR, "벌"
CALLFORM %LOCALS%_OSHIOKI

CALL CHA_CRI_VAR, "연속행동 보정"
CALLFORM %LOCALS%_PREV

CALL CHA_CRI_VAR, "구상 보정치"
CALL ACT_ACTM_KOJO_CORRECTION_T, 0

CALL CHA_CRI_VAR, "ACT 보정치"
CALLFORM %LOCALS%_CORRECTION(ARG)


;ARG가 1이상이라면 처리 중단
SIF ARG
	RETURN RESULT

CALL CHA_CRI_VAR, "실행 판정"
CALLFORM %LOCALS%_ABLE

;────────────────────────────────────
;최종 판정
;────────────────────────────────────
CALL DEF_CRI_VAR("최대 전자")
LOCAL = GET_CRI_VAR("결정")
IF LOCAL == -1
	SIF FLAG:디버그
		PRINTL (회화 ACT분류에 실행 가능한 ACT가 존재하지 않습니다)
	TFLAG:ACT = -1
	CALL ACT_MENU_RESULT(2, "회화")
ELSE
	TFLAG:ACT = GET_ACTNUM(RESULTS)
ENDIF
CALL ANA_CRI_VAR()

;-------------------------------------------------------------------------
;기준치
;-------------------------------------------------------------------------
@ACT_ACTM0_REFERENCE

;필요하지 않을지도라고 생각했으므로 시험삼아 무효화@이것 보고
[SKIPSTART]
CALL ADD_CRI_VAR("지금의기분을얘기한다", 10)
CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", 10)
CALL ADD_CRI_VAR("성에대한이야기를한다", 10)
CALL ADD_CRI_VAR("상냥하게위로한다", 10)
CALL ADD_CRI_VAR("엄격하게위협한다", 10)
CALL ADD_CRI_VAR("의상의변경을요구한다", 0)
CALL ADD_CRI_VAR("합의를요구한다", 10)
CALL ADD_CRI_VAR("벌이라고선언한다", 10)
CALL ADD_CRI_VAR("고함친다", 10)
CALL ADD_CRI_VAR("기분나쁘게웃는다", 10)
CALL ADD_CRI_VAR("매도", 0)
[SKIPEND]

SIF TFLAG:ACT분류 == 4
	CALL ADD_CRI_VAR("매도", 10)

;-------------------------------------------------------------------------
;조교 방침(1=휴식/2=소프트/3=노멀/4=하드/5=이상)
;-------------------------------------------------------------------------
@ACT_ACTM0_MENU

SELECTCASE TFLAG:턴방침
	CASE 2
		SIF !TFLAG:벌플래그
			CALL ADD_CRI_VAR("상냥하게위로한다", 3)
	CASE 3
		CALL ADD_CRI_VAR("지금의기분을얘기한다", 2)
		SIF !TFLAG:벌플래그
			CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", 1)
	CASE 4
		CALL ADD_CRI_VAR("매도", 10)
		SIF !TFLAG:벌플래그
			CALL ADD_CRI_VAR("엄격하게위협한다", 3)
ENDSELECT

;-------------------------------------------------------------
;오늘의 방침
;오늘의 방침(0=언제나 대로/1=A개발/2=벌/3=하드/4=러브러브/5=이상/6=야외/7=아이 만들기/8=휴식/9=안아/10= 봉사/11=귀여워해)
;-------------------------------------------------------------
@ACT_ACTM0_POLYCY
SELECTCASE POLICY("오늘")
	CASE "귀여워해"
		CALL ADD_CRI_VAR("지금의기분을얘기한다", -10)
		CALL ADD_CRI_VAR("성에대한이야기를한다", -10)
		CALL ADD_CRI_VAR("상냥하게위로한다", 5)
		CALL ADD_CRI_VAR("엄격하게위협한다", -10)
		CALL ADD_CRI_VAR("벌이라고선언한다", -10)
		CALL ADD_CRI_VAR("고함친다", -10)
		CALL ADD_CRI_VAR("기분나쁘게웃는다", -10)
	CASEELSE
		;none
ENDSELECT

;-------------------------------------------------------------------------
;조교자의 소질을 참조
;-------------------------------------------------------------------------
@ACT_ACTM0_TALENT_T
;조교자가 얌전하다/거만함
IF TALENT:얌전함
	CALL ADD_CRI_VAR("상냥하게위로한다", , 1)
	CALL ADD_CRI_VAR("고함친다", -4, 2)
ELSEIF TALENT:거만함
	CALL ADD_CRI_VAR("상냥하게위로한다", , -2)
	CALL ADD_CRI_VAR("고함친다", 1, 1)
ENDIF

;조교자가 프라이드높음/낮다
IF TALENT:프라이드높음
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", , -2)
	CALL ADD_CRI_VAR("상냥하게위로한다", , -4)
	CALL ADD_CRI_VAR("의상의변경을요구한다", 2)
	CALL ADD_CRI_VAR("매도", , 2)
ELSEIF TALENT:프라이드낮음
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", , 2)
	CALL ADD_CRI_VAR("상냥하게위로한다", , 4)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", -4)
ENDIF

;조교자가 자제적/충동적
IF TALENT:자제적
	CALL ADD_CRI_VAR("고함친다", -5)
ELSEIF TALENT:충동적
	CALL ADD_CRI_VAR("고함친다", 4, 2)
ENDIF

;조교자가 무관심/호기심
IF TALENT:무관심
	CALL ADD_CRI_VAR("지금의기분을얘기한다", -5)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", -5)
	CALL ADD_CRI_VAR("성에대한이야기를한다", -5)
ELSEIF TALENT:호기심
	CALL ADD_CRI_VAR("지금의기분을얘기한다", 5)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", 5)
	CALL ADD_CRI_VAR("성에대한이야기를한다", 5)
ENDIF

;조교자가 감정결핍/감수성
IF TALENT:감정결핍
	CALL ADD_CRI_VAR("상냥하게위로한다", -3, 4)
	CALL ADD_CRI_VAR("엄격하게위협한다", -4, 2)
	CALL ADD_CRI_VAR("고함친다", -6)
ELSEIF TALENT:감수성
	CALL ADD_CRI_VAR("상냥하게위로한다", 4)
	CALL ADD_CRI_VAR("엄격하게위협한다", 3, 2)
	CALL ADD_CRI_VAR("고함친다", 3, 4)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", , 4)
ENDIF

;조교자가 낙관적/비관적
IF TALENT:낙관적
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", 3)
	CALL ADD_CRI_VAR("의상의변경을요구한다", , 2)
	CALL ADD_CRI_VAR("합의를요구한다", 5)
ELSEIF TALENT:비관적
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", -2, 2)
	CALL ADD_CRI_VAR("의상의변경을요구한다", , -2)
	CALL ADD_CRI_VAR("합의를요구한다", , -6)
ENDIF

;조교자가 선을그음
IF TALENT:선을그음
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", -3)
	CALL ADD_CRI_VAR("합의를요구한다", -5)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", -5)
ENDIF

;조교자가튀고싶어함
IF TALENT:튀고싶어함
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", , 7)
	CALL ADD_CRI_VAR("성에대한이야기를한다", 1, 5)
	CALL ADD_CRI_VAR("엄격하게위협한다", , 6)
	CALL ADD_CRI_VAR("벌이라고선언한다", 3)
	CALL ADD_CRI_VAR("고함친다", , 4)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", , 4)
ENDIF

;조교자가 정조관념/정조관념없음
IF TALENT:정조관념
	CALL ADD_CRI_VAR("합의를요구한다", 7)
ELSEIF TALENT:정조관념없음
	CALL ADD_CRI_VAR("합의를요구한다", -7)
ENDIF

;조교자가 억압/해방
IF TALENT:억압
	CALL ADD_CRI_VAR("성에대한이야기를한다", -10)
	CALL ADD_CRI_VAR("합의를요구한다", -5)
ELSEIF TALENT:해방
	CALL ADD_CRI_VAR("성에대한이야기를한다", , 10)
	CALL ADD_CRI_VAR("합의를요구한다", , 5)
ENDIF

;조교자가 수줍음/수치심옅음
IF TALENT:수줍음
	CALL ADD_CRI_VAR("의상의변경을요구한다", -5)
	CALL ADD_CRI_VAR("합의를요구한다", -5)
ELSEIF TALENT:수치심옅음
	CALL ADD_CRI_VAR("의상의변경을요구한다", 5)
	CALL ADD_CRI_VAR("합의를요구한다", 5)
ENDIF

;조교자가 습득빠름/습득느림
IF TALENT:습득빠름
	CALL ADD_CRI_VAR("성에대한이야기를한다", 5)
ELSEIF TALENT:습득느림
	CALL ADD_CRI_VAR("성에대한이야기를한다", -5)
ENDIF

;조교자가 헌신적
SIF TALENT:헌신적
	CALL ADD_CRI_VAR("상냥하게위로한다", 5)

;조교자가 도착적
IF TALENT:도착적
	CALL ADD_CRI_VAR("엄격하게위협한다", , 4)
	CALL ADD_CRI_VAR("벌이라고선언한다", 4)
	CALL ADD_CRI_VAR("매도", , 4)
ENDIF

;조교자가 새드
IF TALENT:새드
	CALL ADD_CRI_VAR("상냥하게위로한다", -3)
	CALL ADD_CRI_VAR("엄격하게위협한다", 5)
	CALL ADD_CRI_VAR("벌이라고선언한다", 7)
	CALL ADD_CRI_VAR("매도", 7)
ENDIF

;조교자가 신중/조급함
IF TALENT:신중
	CALL ADD_CRI_VAR("합의를요구한다", , -5)
	CALL ADD_CRI_VAR("벌이라고선언한다", -3)
	CALL ADD_CRI_VAR("고함친다", -5)
ELSEIF TALENT:조급함
	CALL ADD_CRI_VAR("합의를요구한다", , 5)
	CALL ADD_CRI_VAR("고함친다", 5)
ENDIF

;조교자가 심술쟁이/상냥함
IF TALENT:심술쟁이
	CALL ADD_CRI_VAR("상냥하게위로한다", -5)
	CALL ADD_CRI_VAR("엄격하게위협한다", , 6)
	CALL ADD_CRI_VAR("벌이라고선언한다", 5)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", 5)
	CALL ADD_CRI_VAR("매도", 5)
ELSEIF TALENT:상냥함
	CALL ADD_CRI_VAR("상냥하게위로한다", 5)
	CALL ADD_CRI_VAR("엄격하게위협한다", -5)
	CALL ADD_CRI_VAR("벌이라고선언한다", -5)
ENDIF

;조교자가 유치
IF TALENT:유치
	CALL ADD_CRI_VAR("성에대한이야기를한다", -5)
	CALL ADD_CRI_VAR("합의를요구한다", -3)
	CALL ADD_CRI_VAR("고함친다", , 7)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", , 4)
ENDIF

;조교자가 광기
IF TALENT:광기
	CALL ADD_CRI_VAR("고함친다", , 6)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", 1, 8)
ENDIF

;조교자가 위압감
SIF TALENT:위압감
	CALL ADD_CRI_VAR("엄격하게위협한다", , 5)

;조교자가 매혹
SIF TALENT:매혹
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", , 5)

;조교자가 사교적/대인기피
IF TALENT:사교적
	CALL ADD_CRI_VAR("지금의기분을얘기한다", 3)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", 3)
	CALL ADD_CRI_VAR("상냥하게위로한다", 3)
ELSEIF TALENT:대인기피
	CALL ADD_CRI_VAR("지금의기분을얘기한다", -3)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", -3)
	CALL ADD_CRI_VAR("상냥하게위로한다", -3)
ENDIF

;조교자가 공기를 읽는 정도의 능력
SIF TALENT:독심술
	CALL ADD_CRI_VAR("지금의기분을얘기한다", -5)

;조교자가 사고를 읽는 정도의 능력… 은, 어떻게 봐도 사토리 같습니다. 정말로(ry
;구상측이 대응하면 오히려+보정한 (분)편이 보다 재미있어질지도 모른다
SIF NO:TARGET == 61
	CALL ADD_CRI_VAR("지금의기분을얘기한다", -10)

;-------------------------------------------------------------------------
;조교 대상의 소질을 참조
;-------------------------------------------------------------------------
@ACT_ACTM0_TALENT_M

;조교 대상이 겁쟁이
SIF TALENT:MASTER:겁쟁이
	CALL ADD_CRI_VAR("상냥하게위로한다", , 5)

;조교 대상이 기장
SIF TALENT:MASTER:기장
	CALL ADD_CRI_VAR("엄격하게위협한다", , 5)

;조교 대상이 감정결핍/감수성
IF TALENT:MASTER:감정결핍
	CALL ADD_CRI_VAR("지금의기분을얘기한다", , 4)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", , 2)
ELSEIF TALENT:MASTER:감수성
	CALL ADD_CRI_VAR("지금의기분을얘기한다", , -4)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", , -2)
ENDIF

;조교 대상이 낙관적/비관적
IF TALENT:MASTER:낙관적
	CALL ADD_CRI_VAR("상냥하게위로한다", , -4)
	CALL ADD_CRI_VAR("엄격하게위협한다", , 2)
ELSEIF TALENT:MASTER:비관적
	CALL ADD_CRI_VAR("상냥하게위로한다", , 2)
	CALL ADD_CRI_VAR("엄격하게위협한다", , -4)
ENDIF

;-------------------------------------------------------------------------
;조교자의 성별의 기호를 참조
;-------------------------------------------------------------------------
@ACT_ACTM0_GENDER_T
;조교자가 바이
IF TALENT:바이
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", , (TALENT:남자 == TALENT:MASTER:남자) ? 2 # 0)
ELSE
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", (TALENT:남자 == TALENT:MASTER:남자) ? -6 # 0)
ENDIF

;조교자가 남성혐오 한편, 조교 대상이 남자
IF TALENT:남성혐오 && TALENT:MASTER:남자
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", -5)
	CALL ADD_CRI_VAR("상냥하게위로한다", -3)
	CALL ADD_CRI_VAR("합의를요구한다", -5)
ENDIF
;-------------------------------------------------------------------------
;조교 대상의 능력을 참조
;-------------------------------------------------------------------------
@ACT_ACTM0_ABL_M

;조교 대상의 순종이[0→0, 5→-5]를 가산(-5～0)
CALL ADD_CRI_VAR("엄격하게위협한다", LINE_CALC(ABL:MASTER:순종, "0→0, 5→-5, LIMIT/-5～0"))

;조교 대상의 욕망이[0→0, 5→5]를 가산(0～7)
CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", LINE_CALC(ABL:MASTER:순종, "0→0, 5→5, LIMIT/0～7"))

;조교 대상의 노출증이[0→0, 5→0～5]를 가산(0～5)
CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", , LINE_CALC(ABL:MASTER:순종, "0→0, 5→5, LIMIT/0～5"))

;────────────────────────────────────
;게이지나 상태에 의한 변동
;────────────────────────────────────
;-------------------------------------
;조교 대상의 쾌감
;-------------------------------------
@ACT_ACTM0_PLEASURE_M

;쾌감과 호의. 쾌ＣＶＡＢ가 높을 때에 자신을 좋아하는가 (듣)묻는… 그러한 수법인가
;조교 대상의 쾌X합계가[0→0, 6000→3, 12000→4, 18000→5, 24000→6, 30000→7]을 가산(0～7)
LOCAL = GET_REVISION_SQRT(PALAM:MASTER:쾌Ｃ + PALAM:MASTER:쾌Ｖ + PALAM:MASTER:쾌Ａ + PALAM:MASTER:쾌Ｂ, 30000, 7)
CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", LIMIT(LOCAL, 0, 7))

;-------------------------------------
;조교 대상의 반항
;-------------------------------------
@ACT_ACTM0_RESISTANCE_M

;조교 대상의 반항이[1500→0, 3000→1, 4500→3, 6000→5, 7500→7]을 가산(0～7)
CALL ADD_CRI_VAR("엄격하게위협한다", LINE_CALC(PALAM:MASTER:반항, "3000→1, 7500→7, LIMIT/0～7"))
CALL ADD_CRI_VAR("벌이라고선언한다", LINE_CALC(PALAM:MASTER:반항, "3000→1, 7500→7, LIMIT/0～7"))
;조교 대상의 반항이[1500→0, 3000→0～2, 4500→0～4, 6000→0～6, 7500→0～8]을 가산(0～8)
CALL ADD_CRI_VAR("고함친다", , LINE_CALC(PALAM:MASTER:반항, "3000→2, 7500→8, LIMIT/0～8"))

;-------------------------------------
;조교 대상의 치정
;-------------------------------------
@ACT_ACTM0_SHYNESS_M

;조교 대상의 치정이[2000→0, 3000→2, 4000→4, 5000→6, 6000→8, 7000→10]을 가산(0～11)
CALL ADD_CRI_VAR("지금의기분을얘기한다", , LINE_CALC(PALAM:MASTER:치정, "2000→0, 7000→10, LIMIT/0～11"))

;-------------------------------------
;조교 대상의 공포
;-------------------------------------
@ACT_ACTM0_FEAR_M

;조교 대상의 공포가[0→0, 2500→1, 5000→2, 7500→3]을 가산(0～3)
;(조교자의 상냥함 경우는 배)
CALL ADD_CRI_VAR("상냥하게위로한다", LINE_CALC(PALAM:MASTER:치정, "0→0, 7500→3, LIMIT/0～3") * (TALENT:상냥함 + 1))

;-------------------------------------
;조교 대상의 억울
;-------------------------------------
@ACT_ACTM0_DEPRESSION_M

;조교 대상의 억울이[0→0, 2500→1, 5000→2, 7500→3]을 가산(0～3)
;(조교자의 상냥함 경우는 배)
CALL ADD_CRI_VAR("상냥하게위로한다", LINE_CALC(PALAM:MASTER:억울, "0→0, 7500→3, LIMIT/0～3") * (TALENT:상냥함 + 1))

;-------------------------------------
;조교 대상의 반발 각인
;-------------------------------------
@ACT_ACTM0_RESISTMARK_M

;조교 대상의 반발 각인이[0→0, 2→0～1, 4→1～4, 6→2～7, 8→3～10, 10→4～13]을 가산(0～13)
CALL ADD_CRI_VAR("엄격하게위협한다", LINE_CALC(MARK:반항각인, "2→0, 10→4, LIMIT/0～4"), LINE_CALC(MARK:반항각인, "2→1, 10→9, LIMIT/0～9"))

;-------------------------------------
;조교 대상의 성지식
;-------------------------------------
@ACT_ACTM0_SEXUALINFO_M

;조교 대상의 성지식이[10→2～5, 15→1～3, 20→0～1, 25→0, 30→-5, 35→-10]을 가산(-10～6)
CALL ADD_CRI_VAR("성에대한이야기를한다", LINE_CALC(EXP:MASTER:성지식, "10→2, 20→0, 25→0, 35→-10, LIMIT/-10～2"), LINE_CALC(EXP:MASTER:성지식, "10→3, 25→0, LIMIT/0～4"))

;-------------------------------------
;조교자의 죄악감
;-------------------------------------
@ACT_ACTM0_SIN_T

;조교자의 죄악감이[20→0, 40→1, 60→2, 80→3]을 가산(0～3)
CALL ADD_CRI_VAR("상냥하게위로한다", LINE_CALC(CFLAG:죄악감, "20→0, 80→3, LIMIT/0～3"))
;조교자의 죄악감이[0→0, 20→-1, 40→-2, 60→-3, 80→-4, 100→-5]를 가산(-5～0)
CALL ADD_CRI_VAR("엄격하게위협한다", LINE_CALC(CFLAG:죄악감, "0→0, 100→-5, LIMIT/-5～0"))
CALL ADD_CRI_VAR("벌이라고선언한다", LINE_CALC(CFLAG:죄악감, "0→0, 100→-5, LIMIT/-5～0"))

;-------------------------------------
;조교자의 ALI
;-------------------------------------
@ACT_ACTM0_ALI_T

;조교자의 ALI가[-50→-6～-3, 0→0, 50→3～6]을 가산(-6～6)
CALL ADD_CRI_VAR("상냥하게위로한다", LINE_CALC(CFLAG:아라이먼트, "-50→-3, 0→0, 50→3, LIMIT/-3～3"), LINE_CALC(CFLAG:아라이먼트, "-50→-3, 0→0, 50→3, LIMIT/-3～3"))
;조교자의 ALI가[-50→3～6, 0→0, 50→-6～-3]을 가산(-6～6)
CALL ADD_CRI_VAR("엄격하게위협한다", LINE_CALC(CFLAG:아라이먼트, "-50→3, 0→0, 50→-3, LIMIT/-3～3"), LINE_CALC(CFLAG:아라이먼트, "-50→3, 0→0, 50→-3, LIMIT/-3～3"))
;조교자의 ALI가[-20→0, 0→3, 20→0]을 가산(0～3)
CALL ADD_CRI_VAR("지금의기분을얘기한다", LINE_CALC(CFLAG:아라이먼트, "-20→0, 0→3, 20→0, LIMIT/0～3"))
;조교자의 ALI가[-10→0, 0→2, 10→0]을 가산(0～2)
CALL ADD_CRI_VAR("지금의기분을얘기한다", LINE_CALC(CFLAG:아라이먼트, "-10→0, 0→2, 10→0, LIMIT/0～2"))

;-------------------------------------
;조교자의 이성
;-------------------------------------
@ACT_ACTM0_REASON_T

;조교자의 이성이[0→4～8, 250→2～4, 500→0, 750→-2, 1000→-4]를 가산(-4～8)
CALL ADD_CRI_VAR("고함친다", LINE_CALC(BASE:이성, "0→4, 1000→-4, LIMIT/-4～4"), LINE_CALC(BASE:이성, "0→4, 500→0, LIMIT/0～4"))
;조교자의 이성이[0→0～8, 250→0～4, 500→0, 750→-4～0]을 가산(-4～8)
CALL ADD_CRI_VAR("기분나쁘게웃는다", , LINE_CALC(BASE:이성, "0→8, 750→-4, LIMIT/-4～8"))

;-------------------------------------
;조교자의 흥미
;-------------------------------------
@ACT_ACTM0_INTEREST_T

;조교자의 흥미가[100→-5, 200→-4, 300→-3, 400→-2, 500→-1, 600→0]을 가산(-5～0)
CALL ADD_CRI_VAR("지금의기분을얘기한다", LINE_CALC(BASE:흥미, "100→-5, 600→0, LIMIT/-5～0"))
CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", LINE_CALC(BASE:흥미, "100→-5, 600→0, LIMIT/-5～0"))

;-------------------------------------
;조교자의 초조
;-------------------------------------
@ACT_ACTM0_IRRITATION_T

;조교자의 초조가[0→0, 200→1～2, 400→2～4, 600→3～6, 800→4～8, 1000→5～10]을 가산(0～10)
CALL ADD_CRI_VAR("고함친다", LINE_CALC(BASE:초조, "0→0, 1000→5, LIMIT/0～5"), LINE_CALC(BASE:초조, "0→0, 1000→5, LIMIT/0～5"))
;조교자의 초조가[0→0, 200→1, 400→2, 600→3, 800→4, 1000→5]를 가산(0～6)
CALL ADD_CRI_VAR("벌이라고선언한다", LINE_CALC(BASE:초조, "0→0, 1000→5, LIMIT/0～6"))

;-------------------------------------
;조교자의 만족
;-------------------------------------
@ACT_ACTM0_SATISFACTION_T

;조교자의 만족이[0→0, 1000→-3]을 가산(-3～0)
CALL ADD_CRI_VAR("벌이라고선언한다", LINE_CALC(BASE:만족, "0→0, 1000→-3, LIMIT/-3～0"))
CALL ADD_CRI_VAR("매도", LINE_CALC(BASE:만족, "0→0, 1000→-3, LIMIT/-3～0"))
;조교자의 만족이[0→0, 1000→-5]를 가산(-5～0)
CALL ADD_CRI_VAR("엄격하게위협한다", LINE_CALC(BASE:만족, "0→0, 1000→-5, LIMIT/-5～0"))
CALL ADD_CRI_VAR("고함친다", LINE_CALC(BASE:만족, "0→0, 1000→-5, LIMIT/-5～0"))

;-------------------------------------
;조교자 상태(0=통상/1=피폐/2=쇠약/3=무기력/4=몽롱/5=정욕/6=분노/7=싫증/8=울적)
;-------------------------------------
@ACT_ACTM0_CONDITION_T
SELECTCASE GET_CONDITION(TARGET)
	;CASE "피폐"
	;CASE "쇠약"
	CASE "무기력"
		CALL ADD_CRI_VAR("고함친다", -5)
	CASE "몽롱"
		CALL ADD_CRI_VAR("상냥하게위로한다", , -4)
		CALL ADD_CRI_VAR("엄격하게위협한다", , -4)
		CALL ADD_CRI_VAR("고함친다", , -4)
	CASE "정욕"
		CALL ADD_CRI_VAR("성에대한이야기를한다", 5)
		CALL ADD_CRI_VAR("합의를요구한다", 6)
	CASE "분노"
		CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", -3)
		CALL ADD_CRI_VAR("성에대한이야기를한다", -3)
		CALL ADD_CRI_VAR("상냥하게위로한다", -5)
		CALL ADD_CRI_VAR("엄격하게위협한다", , 2)
		CALL ADD_CRI_VAR("벌이라고선언한다", 3)
		CALL ADD_CRI_VAR("고함친다", 5)
		CALL ADD_CRI_VAR("매도", 3)
	CASE "지루함"
		CALL ADD_CRI_VAR("고함친다", , 4)
		CALL ADD_CRI_VAR("기분나쁘게웃는다", 6)
		CALL ADD_CRI_VAR("매도", , 4)
	CASE "울적"
		CALL ADD_CRI_VAR("고함친다", , 4)
		CALL ADD_CRI_VAR("기분나쁘게웃는다", 6)
		CALL ADD_CRI_VAR("매도", , 4)
ENDSELECT

;────────────────────────────────────
;전회의 행동이나 상황에 의한 변동
;────────────────────────────────────
;-------------------------------------
;장착 도구류(바이브, 애널바이브, 애널비즈, 관장＋애널 플러그, 클리캡, 오나홀, 니플캡)
;-------------------------------------
@ACT_ACTM0_TOOLS

LOCAL = TEQUIP:바이브 + TEQUIP:애널바이브 + TEQUIP:애널비즈 + (TEQUIP:관장기＋플러그 * 3) + TEQUIP:클리캡 + TEQUIP:오나홀 + TEQUIP:니플캡
;장착 도구류에 의한 보정치가[0→0, 2→1, 4→2, 6→3, 8→4, 10→5]를 가산(0～6)
CALL ADD_CRI_VAR("지금의기분을얘기한다", LINE_CALC(LOCAL, "0→0, 10→5, LIMIT/0～6"))

;-------------------------------------
;미약
;-------------------------------------
@ACT_ACTM0_DRAG

IF TEQUIP:미약
	CALL ADD_CRI_VAR("지금의기분을얘기한다", TEQUIP:미약 / 2)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", TEQUIP:미약)
ENDIF

;-------------------------------------
;ＳＭ계 도구(줄, 아이마스크, 볼개그, 삼각목마)
;-------------------------------------
@ACT_ACTM0_ROPE
IF TEQUIP:줄
	CALL ADD_CRI_VAR("지금의기분을얘기한다", 1)
	CALL ADD_CRI_VAR("엄격하게위협한다", 2)
ENDIF

@ACT_ACTM0_EYEMASK
IF TEQUIP:아이마스크
	CALL ADD_CRI_VAR("지금의기분을얘기한다", 3)
	CALL ADD_CRI_VAR("엄격하게위협한다", 2)
ENDIF

@ACT_ACTM0_GAG
IF TEQUIP:볼개그
	CALL ADD_CRI_VAR("지금의기분을얘기한다", -5)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", -10)
	CALL ADD_CRI_VAR("합의를요구한다", -10)
ENDIF

@ACT_ACTM0_HORSE
IF TEQUIP:삼각목마
	CALL ADD_CRI_VAR("지금의기분을얘기한다", (TALENT:새드 || TALENT:심술쟁이) ? 3 # 0)
	CALL ADD_CRI_VAR("상냥하게위로한다", -5)
	CALL ADD_CRI_VAR("엄격하게위협한다", 3)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", 5)
ENDIF

;-------------------------------------
;야외플레이중
;-------------------------------------
@ACT_ACTM0_OUT
IF TEQUIP:야외플레이
	CALL ADD_CRI_VAR("지금의기분을얘기한다", 3)
	CALL ADD_CRI_VAR("엄격하게위협한다", , 4)
ENDIF

;-------------------------------------
;조교 대상이 자위중
;-------------------------------------
@ACT_ACTM0_MASTURBATION_M
IF GETBIT(TEQUIP:자위중, 0)
	CALL ADD_CRI_VAR("지금의기분을얘기한다", (TALENT:새드 || TALENT:심술쟁이) ? 8 # 2)
	CALL ADD_CRI_VAR("의상의변경을요구한다", -5)
ENDIF

;-------------------------------------
;조교자가 자위중
;-------------------------------------
@ACT_ACTM0_MASTURBATION_T
IF GETBIT(TEQUIP:자위중, 1)
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", (TALENT:도착적 || TALENT:광기) ? 5 # 0)
	CALL ADD_CRI_VAR("상냥하게위로한다", -3)
	CALL ADD_CRI_VAR("엄격하게위협한다", -3)
	CALL ADD_CRI_VAR("벌이라고선언한다", -5)
	CALL ADD_CRI_VAR("고함친다", -5)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", -5)
ENDIF

;-------------------------------------
;조교자 삽입중
;-------------------------------------
@ACT_ACTM0_INSERT
IF TEQUIP:성교중
	CALL ADD_CRI_VAR("지금의기분을얘기한다", (TALENT:새드 || TALENT:심술쟁이) ? 5 # 0)
	CALL ADD_CRI_VAR("벌이라고선언한다", -5)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", -5)
ENDIF

;-------------------------------------
;의상 관련, 아직도 조정할 필요가 있습니다…
;회화계는 방해도는 아니고, 입고 있을까에서의 판단
;-------------------------------------
;조교 대상의 복장
;-------------------------------------
@ACT_ACTM0_CLOTH_M
;윗도리
;조교 대상이 상하 양쪽 모두의 윗도리를 입고 있을 때
IF CLOTHESTYPE(1, 1) && CLOTHESTYPE(1, 3)
	CALL ADD_CRI_VAR("의상의변경을요구한다", 12)
	;조교자가 억압/해방
	IF TALENT:억압
		CALL ADD_CRI_VAR("의상의변경을요구한다", -4)
	ELSEIF TALENT:해방
		CALL ADD_CRI_VAR("의상의변경을요구한다", 4)
	ENDIF
;조교 대상이 상하 어느 쪽인가의 윗도리를 입고 있을 때
ELSEIF CLOTHESTYPE(1, 1) || CLOTHESTYPE(1, 3)
	CALL ADD_CRI_VAR("의상의변경을요구한다", 10)
	;조교자가 억압/해방
	IF TALENT:억압
		CALL ADD_CRI_VAR("의상의변경을요구한다", -3)
	ELSEIF TALENT:해방
		CALL ADD_CRI_VAR("의상의변경을요구한다", 3)
	ENDIF
ENDIF

;속옷
;조교 대상이 상하 양쪽 모두의 속옷을 입고 있을 때
IF CLOTHESTYPE(1, 0) && CLOTHESTYPE(1, 2)
	CALL ADD_CRI_VAR("의상의변경을요구한다", 8)
	;조교자가 억압/해방
	IF TALENT:억압
		CALL ADD_CRI_VAR("의상의변경을요구한다", -4)
	ELSEIF TALENT:해방
		CALL ADD_CRI_VAR("의상의변경을요구한다", 4)
	ENDIF
;조교 대상이 상하 어느 쪽인가의 속옷을 입고 있을 때
ELSEIF CLOTHESTYPE(1, 0) || CLOTHESTYPE(1, 2)
	CALL ADD_CRI_VAR("의상의변경을요구한다", 6)
	;조교자가 억압/해방
	IF TALENT:억압
		CALL ADD_CRI_VAR("의상의변경을요구한다", -3)
	ELSEIF TALENT:해방
		CALL ADD_CRI_VAR("의상의변경을요구한다", 3)
	ENDIF
ENDIF

;조교 대상이 몇개의 윗도리/속옷류를 입고 있을 때
IF CLOTHESTYPE(1, 1) || CLOTHESTYPE(1, 3) || CLOTHESTYPE(1, 0) || CLOTHESTYPE(1, 2)
	CALL ADD_CRI_VAR("의상의변경을요구한다", 2, 4)
	;조교자가 선을그음
	SIF TALENT:선을그음
		CALL ADD_CRI_VAR("의상의변경을요구한다", -5)
	;조교자가 도착적
	SIF TALENT:도착적
		CALL ADD_CRI_VAR("의상의변경을요구한다", -3, 4)
	;조교자가 바이가 아니고, 한편 조교 대상이 동성
	SIF !TALENT:바이 && !(TALENT:남자 ^^ TALENT:MASTER:남자)
		CALL ADD_CRI_VAR("의상의변경을요구한다", -3)
	;조교자가 남성혐오 한편, 조교 대상이 남자
	SIF TALENT:남성혐오 && TALENT:MASTER:남자
		CALL ADD_CRI_VAR("의상의변경을요구한다", -5)
ENDIF

;조교 대상이 코스프레중. 질릴 때까지 의상 변경하지 않도록
IF TEQUIP:MASTER:코스프레
	;조교자의 흥미
	SELECTCASE BASE:흥미
		CASE IS > 750
			CALL ADD_CRI_VAR("의상의변경을요구한다", 0)
		CASE IS > 500
			CALL ADD_CRI_VAR("의상의변경을요구한다", -10)
		CASE IS > 250
			CALL ADD_CRI_VAR("의상의변경을요구한다", -5)
		CASEELSE
			CALL ADD_CRI_VAR("의상의변경을요구한다", 5)
	ENDSELECT
ENDIF

;-------------------------------------
;허가를 청했는지 개, 조교자 상태가 울적 이외
;-------------------------------------
@ACT_ACTM0_PLEASE_HELP

IF IS_NOWCOMNAME("용서를빈다") && TCVAR:상태변화 < 8
	CALL ADD_CRI_VAR("엄격하게위협한다", -5)
	CALL ADD_CRI_VAR("고함친다", -5)
	CALL ADD_CRI_VAR("매도", -5)
ENDIF

;-------------------------------------
;그런 이야기는 벌써 끝난 플래그(1=호의, 2=지식, 4=위로해, 8=위협하는, 16=합의, 32=비웃는, 64=매도)
;-------------------------------------
@ACT_ACTM0_ALREADY_TALKED

LOCAL = LIMIT(ABL:회화 / 2 - 5, -5, 0)
SIF TFLAG:기출의화제 & 1
	CALL ADD_CRI_VAR("자신에게로의기분을얘기한다", LOCAL)
SIF TFLAG:기출의화제 & 2
	CALL ADD_CRI_VAR("성에대한이야기를한다", LOCAL)
SIF TFLAG:기출의화제 & 4
	CALL ADD_CRI_VAR("상냥하게위로한다", LOCAL)
SIF TFLAG:기출의화제 & 8
	CALL ADD_CRI_VAR("엄격하게위협한다", LOCAL)
SIF TFLAG:기출의화제 & 16
	CALL ADD_CRI_VAR("합의를요구한다", LOCAL)
SIF TFLAG:기출의화제 & 32
	CALL ADD_CRI_VAR("기분나쁘게웃는다", LOCAL)
SIF TFLAG:기출의화제 & 64
	CALL ADD_CRI_VAR("매도", LOCAL)

;-------------------------------------
;벌모드
;-------------------------------------
@ACT_ACTM0_OSHIOKI

IF TFLAG:벌플래그
	CALL ADD_CRI_VAR("벌이라고선언한다", 8, 5)
	CALL ADD_CRI_VAR("기분나쁘게웃는다", , 7)
	CALL ADD_CRI_VAR("매도", 6, 7)
ENDIF

;────────────────────────────────────
;같은 행동 연속 실행의 확률을 다운합니다
;────────────────────────────────────
@ACT_ACTM0_PREV

SELECTCASE TFLAG:전ACT
	CASE 0 TO 9, 66
		CALL ADD_CRI_VAR(GET_ACTNAME(TFLAG:전ACT), -3 * TFLAG:동일행동보너스, -4 * TFLAG:동일행동보너스)
ENDSELECT

;────────────────────────────────────
;보정치 계산
;────────────────────────────────────
@ACT_ACTM0_CORRECTION(ARG)
#DIM LCOUNT

;ARG가 0이외라면 보정치를 계산해, 이후의 처리를 실시하지 않는다
IF ARG
	;66에 관해서는 여기서 계산하지 않는다
	FOR LCOUNT, 0, 10
		CALL ACT_M_RES_CALC(LCOUNT, GET_CRI_VAR(GET_ACTNAME(LCOUNT) + "누계"))
	NEXT
ELSE
	;보정치를 판정치에 가산한다
	CALL ACT_ACTM_CORRECTION(0)
ENDIF

;────────────────────────────────────
;실행 불가능의 판정
;────────────────────────────────────
@ACT_ACTM0_ABLE
#DIM LCOUNT

;불가능 판정
CALL ACT_ACTM_ABLE(0)

