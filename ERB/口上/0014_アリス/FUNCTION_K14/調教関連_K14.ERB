;==================================================
;
;			調教関連関数置き場
;
;	調教時の各種参照、判定、捏造用関数類
;
;version		Reason
;1.62			本体の変数仕様変更に対応。一部不具合を修正
;1.61			参照していた関数の誤りを修正
;
;==================================================

;-------------------------------------------------
;関数名:GET_EX_K14
;概　要:文字列でEX関連を参照する
;引　数:ARGS…絶頂の種類
;戻り値:指定した文字列に準じたNOWEX
;使用例:GET_EX_K14("MC絶頂")
;-------------------------------------------------
@GET_EX_K14(ARGS)
#FUNCTION
#LOCALSIZE 30
SPLIT ARGS, "/", LOCALS

LOCAL:0 = NOWEX:MASTER:Ｃ絶頂
LOCAL:1 = NOWEX:MASTER:Ｖ絶頂
LOCAL:2 = NOWEX:MASTER:Ａ絶頂
LOCAL:3 = NOWEX:MASTER:Ｂ絶頂
LOCAL:4 = NOWEX:MASTER:噴乳
LOCAL:5 = NOWEX:MASTER:射精
LOCAL:6 = NOWEX:MASTER:放尿
LOCAL:7 = NOWEX:Ｃ絶頂
LOCAL:8 = NOWEX:Ｖ絶頂
LOCAL:9 = NOWEX:Ａ絶頂
LOCAL:10 = NOWEX:Ｂ絶頂
LOCAL:11 = NOWEX:噴乳
LOCAL:12 = NOWEX:射精
LOCAL:13 = NOWEX:MASTER:潮吹き

;潮吹きが追加されたけど番号入れ替えるの面倒なんで取りあえずLOCAL:13で
SELECTCASE ARGS
	CASE "MC絶頂"
		RETURNF LOCAL:0
	CASE "MV絶頂"
		RETURNF LOCAL:1
	CASE "MA絶頂"
		RETURNF LOCAL:2
	CASE "MB絶頂"
		RETURNF LOCAL:3
	CASE "M噴乳"
		RETURNF LOCAL:4
	CASE "M射精"
		RETURNF LOCAL:5
	CASE "M空射精"
		RETURNF LOCAL:5 == 1
	CASE "M大量射精"
		RETURNF LOCAL:5 == 3
	CASE "M早漏射精"
		RETURNF LOCAL:5 == 4
	CASE "MA責め射精"
		RETURNF LOCAL:5 == 5
	CASE "M通常射精"
		RETURNF LOCAL:5 == 2
	CASE "M放尿"
		RETURNF LOCAL:6
	CASE "TC絶頂"
		RETURNF LOCAL:7
	CASE "TV絶頂"
		RETURNF LOCAL:8
	CASE "TA絶頂"
		RETURNF LOCAL:9
	CASE "TB絶頂"
		RETURNF LOCAL:10
	CASE "T噴乳"
		RETURNF LOCAL:11
	CASE "T射精"
		RETURNF LOCAL:12
	CASE "T空射精"
		RETURNF LOCAL:12 == 1
	CASE "T大量射精"
		RETURNF LOCAL:12 == 3
	CASE "T通常射精"
		RETURNF LOCAL:12 == 2
	CASE "M潮吹き"
		RETURNF LOCAL:13
	CASE "M_CVAB絶頂"
		RETURNF LOCAL:0 > 0 && LOCAL:1 > 0 && LOCAL:2 > 0 && LOCAL:3 > 0
	CASE "M_CVA絶頂"
		RETURNF LOCAL:0 > 0 && LOCAL:1 > 0 && LOCAL:2 > 0
	CASE "M_VAB絶頂"
		RETURNF LOCAL:1 > 0 && LOCAL:2 > 0 && LOCAL:3 > 0
	CASE "M_CVB絶頂"
		RETURNF LOCAL:0 > 0 && LOCAL:1 > 0 && LOCAL:3 > 0
	CASE "M_CV絶頂"
		RETURNF LOCAL:0 > 0 && LOCAL:1 > 0
	CASE "M_CA絶頂"
		RETURNF LOCAL:0 > 0 && LOCAL:2 > 0
	CASE "M_CB絶頂"
		RETURNF LOCAL:0 > 0 && LOCAL:3 > 0
	CASE "M_VA絶頂"
		RETURNF LOCAL:1 > 0 && LOCAL:2 > 0
	CASE "M_VB絶頂"
		RETURNF LOCAL:1 > 0 && LOCAL:3 > 0
	CASE "M_AB絶頂"
		RETURNF LOCAL:2 > 0 && LOCAL:3 > 0
	CASE "T_CVAB絶頂"
		RETURNF LOCAL:7 > 0 && LOCAL:8 > 0 && LOCAL:9 > 0 && LOCAL:10 > 0
	CASE "T_CVA絶頂"
		RETURNF LOCAL:7 > 0 && LOCAL:8 > 0 && LOCAL:9 > 0
	CASE "T_CVB絶頂"
		RETURNF LOCAL:7 > 0 && LOCAL:8 > 0 && LOCAL:10 > 0
	CASE "T_VAB絶頂"
		RETURNF LOCAL:8 > 0 && LOCAL:9 > 0 && LOCAL:10 > 0
	CASE "T_CV絶頂"
		RETURNF LOCAL:7 > 0 && LOCAL:8 > 0
	CASE "T_CA絶頂"
		RETURNF LOCAL:7 > 0 && LOCAL:9 > 0
	CASE "T_CB絶頂"
		RETURNF LOCAL:7 > 0 && LOCAL:10 > 0
	CASE "T_VA絶頂"
		RETURNF LOCAL:8 > 0 && LOCAL:9 > 0
	CASE "T_VB絶頂"
		RETURNF LOCAL:8 > 0 && LOCAL:10 > 0
	CASE "T_AB絶頂"
		RETURNF LOCAL:9 > 0 && LOCAL:10 > 0
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@GET_EX_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT
RETURNF 0

;=================================================
;部位別愛撫物判定関数類
;=================================================
;MC_PLAYERとか判り難いので文字列で返す事にしてみる
;基本的にEV20 絶頂口上での使用を想定
;用途を絞りXX_PLAYERの引数が真の場合のみ想定
;-------------------------------------------------

;-------------------------------------------------
;関数名:MC_CHECK_K14
;概　要:MASTER用Ｃ愛撫物判定関数
;引　数:ARGS…当該箇所の愛撫物を表す文字列
;戻り値:MC_PLAYERの引数が偽である場合に準拠したもの
;備　考:式中関数
;-------------------------------------------------
@MC_CHECK_K14(ARGS)
#FUNCTION
#LOCALSIZE 10
LOCAL = MC_PLAYER(1)
SPLIT ARGS, "/", LOCALS

SELECTCASE ARGS
	CASE "口"
		RETURNF LOCAL == 1
	CASE "手"
		RETURNF LOCAL == 2
	CASE "ペニス"
		RETURNF LOCAL == 3
	CASE "ヴァギナ"
		RETURNF LOCAL == 4
	CASE "アナル"
		RETURNF LOCAL == 5
	CASE "胸"
		RETURNF LOCAL == 6
	CASE "足"
		RETURNF LOCAL == 7
	CASE "膣口"
		RETURNF LOCAL == 8
	CASE "ローター"
		RETURNF LOCAL == 100
	CASE "ペニスバンド"
		RETURNF LOCAL == 103
	CASE "クリキャップ"
		RETURNF LOCAL == 112
	CASE "オナホール"
		RETURNF LOCAL == 114
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@MC_CHECK_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT

;-------------------------------------------------
;関数名:MV_CHECK_K14
;概　要:MASTER用Ｖ愛撫物判定関数
;引　数:ARGS…当該箇所の愛撫物を表す文字列
;戻り値:MV_PLAYERの引数が偽である場合に準拠したもの
;備　考:式中関数
;-------------------------------------------------
@MV_CHECK_K14(ARGS)
#FUNCTION
#LOCALSIZE 10
LOCAL = MV_PLAYER(1)
SPLIT ARGS, "/", LOCALS

SELECTCASE ARGS
	CASE "口"
		RETURNF LOCAL == 1
	CASE "手"
		RETURNF LOCAL == 2
	CASE "ペニス"
		RETURNF LOCAL == 3
	CASE "ヴァギナ"
		RETURNF LOCAL == 4
	CASE "アナル"
		RETURNF LOCAL == 5
	CASE "胸"
		RETURNF LOCAL == 6
	CASE "足"
		RETURNF LOCAL == 7
	CASE "腕"
		RETURNF LOCAL == 10
	CASE "ローター"
		RETURNF LOCAL == 100
	CASE "バイブ"
		RETURNF LOCAL == 101
	CASE "ペニスバンド"
		RETURNF LOCAL == 103
	CASE "三角木馬"
		RETURNF LOCAL == 133
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@MV_CHECK_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT

;-------------------------------------------------
;関数名:MA_CHECK_K14
;概　要:MASTER用Ａ愛撫物判定関数
;引　数:ARGS…当該箇所の愛撫物を表す文字列
;戻り値:MA_PLAYERの引数が偽である場合に準拠したもの
;備　考:式中関数
;-------------------------------------------------
@MA_CHECK_K14(ARGS)
#FUNCTION
#LOCALSIZE 10
LOCAL = MA_PLAYER(1)
SPLIT ARGS, "/", LOCALS

SELECTCASE ARGS
	CASE "口"
		RETURNF LOCAL == 1
	CASE "手"
		RETURNF LOCAL == 2
	CASE "ペニス"
		RETURNF LOCAL == 3
	CASE "ヴァギナ"
		RETURNF LOCAL == 4
	CASE "アナル"
		RETURNF LOCAL == 5
	CASE "胸"
		RETURNF LOCAL == 6
	CASE "足"
		RETURNF LOCAL == 7
	CASE "腕"
		RETURNF LOCAL == 10
	CASE "ローター"
		RETURNF LOCAL == 100
	CASE "アナルビーズ"
		RETURNF LOCAL == 102
	CASE "ペニスバンド"
		RETURNF LOCAL == 103
	CASE "アナルバイブ"
		RETURNF LOCAL == 111
	CASE "浣腸器＋プラグ"
		RETURNF LOCAL == 132
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@MA_CHECK_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT

;-------------------------------------------------
;関数名:MB_CHECK_K14
;概　要:MASTER用Ｂ愛撫物判定関数
;引　数:ARGS…当該箇所の愛撫物を表す文字列
;戻り値:MB_PLAYERの引数が偽である場合に準拠したもの
;備　考:式中関数
;-------------------------------------------------
@MB_CHECK_K14(ARGS)
#FUNCTION
#LOCALSIZE 10
LOCAL = MB_PLAYER(1)
SPLIT ARGS, "/", LOCALS

SELECTCASE ARGS
	CASE "口"
		RETURNF LOCAL == 1
	CASE "手"
		RETURNF LOCAL == 2
	CASE "ペニス"
		RETURNF LOCAL == 3
	CASE "ヴァギナ"
		RETURNF LOCAL == 4
	CASE "アナル"
		RETURNF LOCAL == 5
	CASE "胸"
		RETURNF LOCAL == 6
	CASE "足"
		RETURNF LOCAL == 7
	CASE "腕"
		RETURNF LOCAL == 10
	CASE "ローター"
		RETURNF LOCAL == 100
	CASE "ニプルキャップ"
		RETURNF LOCAL == 113
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@MB_CHECK_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT

;-------------------------------------------------
;関数名:TC_CHECK_K14
;概　要:TARGET用ｃ愛撫物判定関数
;引　数:ARGS…当該箇所の愛撫物を表す文字列
;戻り値:TC_PLAYERの引数が偽である場合に準拠したもの
;備　考:式中関数
;-------------------------------------------------
@TC_CHECK_K14(ARGS)
#FUNCTION
#LOCALSIZE 10
LOCAL = TC_PLAYER(1)
SPLIT ARGS, "/", LOCALS

SELECTCASE ARGS
	CASE "口"
		RETURNF LOCAL == 1
	CASE "手"
		RETURNF LOCAL == 2
	CASE "ペニス"
		RETURNF LOCAL == 3
	CASE "ヴァギナ"
		RETURNF LOCAL == 4
	CASE "アナル"
		RETURNF LOCAL == 5
	CASE "胸"
		RETURNF LOCAL == 6
	CASE "足"
		RETURNF LOCAL == 7
	CASE "膣口"
		RETURNF LOCAL == 8
	CASE "ペニスバンド"
		RETURNF LOCAL == 103
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@TC_CHECK_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT

;-------------------------------------------------
;関数名:TV_CHECK_K14
;概　要:TARGET用ｖ愛撫物判定関数
;引　数:ARGS…当該箇所の愛撫物を表す文字列
;戻り値:TV_PLAYERの引数が偽である場合に準拠したもの
;備　考:式中関数
;-------------------------------------------------
@TV_CHECK_K14(ARGS)
#FUNCTION
#LOCALSIZE 10
LOCAL = TV_PLAYER(1)
SPLIT ARGS, "/", LOCALS

SELECTCASE ARGS
	CASE "口"
		RETURNF LOCAL == 1
	CASE "手"
		RETURNF LOCAL == 2
	CASE "ペニス"
		RETURNF LOCAL == 3
	CASE "ヴァギナ"
		RETURNF LOCAL == 4
	CASE "アナル"
		RETURNF LOCAL == 5
	CASE "胸"
		RETURNF LOCAL == 6
	CASE "足"
		RETURNF LOCAL == 7
	CASE "腕"
		RETURNF LOCAL == 10
	CASE "ローター"
		RETURNF LOCAL == 100
	CASE "バイブ"
		RETURNF LOCAL == 101
	CASE "ペニスバンド"
		RETURNF LOCAL == 103
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@TV_CHECK_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT

;-------------------------------------------------
;関数名:TA_CHECK_K14
;概　要:TARGET用ａ愛撫物判定関数
;引　数:ARGS…当該箇所の愛撫物を表す文字列
;戻り値:TA_PLAYERの引数が偽である場合に準拠したもの
;備　考:式中関数
;-------------------------------------------------
@TA_CHECK_K14(ARGS)
#FUNCTION
#LOCALSIZE 10
LOCAL = TA_PLAYER(1)
SPLIT ARGS, "/", LOCALS

SELECTCASE ARGS
	CASE "口"
		RETURNF LOCAL == 1
	CASE "手"
		RETURNF LOCAL == 2
	CASE "ペニス"
		RETURNF LOCAL == 3
	CASE "ヴァギナ"
		RETURNF LOCAL == 4
	CASE "アナル"
		RETURNF LOCAL == 5
	CASE "胸"
		RETURNF LOCAL == 6
	CASE "足"
		RETURNF LOCAL == 7
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@TA_CHECK_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT

;-------------------------------------------------
;関数名:TB_CHECK_K14
;概　要:TARGET用ｂ愛撫物判定関数
;引　数:ARGS…当該箇所の愛撫物を表す文字列
;戻り値:TB_PLAYERの引数が偽である場合に準拠したもの
;備　考:式中関数
;-------------------------------------------------
@TB_CHECK_K14(ARGS)
#FUNCTION
#LOCALSIZE 10
LOCAL = TB_PLAYER(1)
SPLIT ARGS, "/", LOCALS

SELECTCASE ARGS
	CASE "口"
		RETURNF LOCAL == 1
	CASE "手"
		RETURNF LOCAL == 2
	CASE "ペニス"
		RETURNF LOCAL == 3
	CASE "ヴァギナ"
		RETURNF LOCAL == 4
	CASE "アナル"
		RETURNF LOCAL == 5
	CASE "胸"
		RETURNF LOCAL == 6
	CASE "足"
		RETURNF LOCAL == 7
	CASEELSE
		CALLF PRINT_ERRORMESSAGE(@"@TB_CHECK_K14に無効な定義が渡されました")
		RETURNF -1
ENDSELECT

;=================================================
;捏造系関数
;=================================================
;-------------------------------------------------
;関数名:SET_FINGERING_K14
;概　要:任意の箇所で手によるＶ愛撫の処理を行い経験を付与する
;引　数:なし
;使用例 CALL SET_FINGERING_K14
;-------------------------------------------------
@SET_FINGERING_K14
#LOCALSIZE 1
;指挿入れに伴う一連の処理 不潔SOURCEについては割愛
SOURCE:MASTER:快Ｖ = 90 + ACT_FROM(TARGET, 3) * (2 + TALENT:器用な指先) / 2
;調教レベルに応じて接触SOURCE増加
SOURCE:MASTER:接触 = 80 + GET_TRAINLV(TARGET) * 5
;快ＶSOURCEに応じて性行動SOURCE増加
SOURCE:MASTER:性行動 = 80 + SOURCE:MASTER:快Ｖ / 10
;汚れが相互に移動
CALL MOVE_STAIN("手", TARGET, "ヴァギナ", MASTER)
;経験を付与
EXP:手淫経験 += 1
