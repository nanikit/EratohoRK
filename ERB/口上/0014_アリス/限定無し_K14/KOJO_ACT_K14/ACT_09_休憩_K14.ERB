;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#
;
;	アリス口上 休憩系アクション口上ファイル
;
;	休憩系アクション口上をまとめたファイル
;
;Version		Reason
;1.71			@口上記入チェック仕様に。その他加筆、修正等
;1.60			ACT分類単体ファイルとして独立。旧仕様のACTを削除
;
;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#

;========================================================================
;休憩系 ACT90～92
;========================================================================
;・TFLAG:ACT(90=休ませる/91=栄養剤を飲ませる/92=治療する)
;・TFLAG:ACT分類 == 9に該当
;・汎用リアクションにおいてはMENUMATCH(TFLAG:ACT, "休憩")で参照する事が可能
;・ACT91, 栄養剤を飲ませるとACT92, 治療するの発生には特定の素質が条件となる
;-------------------------------------------------

;────────────────────────────────────
;ACT90, 休ませる
;────────────────────────────────────
;・この時点では命令のみ
;・顔面騎乗系は解除される
;・拘束系TEQUIP(縄/アイマスク/ボールギャグ/三角木馬)は解除される
;・汚れはリセットされる
;・調教者、調教対象の自慰は中断
;・リアクションが"自慰し始める"だった場合"勝手に自慰をし始めた"に派生する
;・持続系道具(バイブ/アナルバイブ/アナルビーズ/浣腸器＋プラグ/ニプルキャップ)装着時は
;・道具のせいであまり休めなかったに派生する
;-------------------------------------------------
@KOJO_ACT_K14_90
;-------------------------------------------------
;・TFLAG:ACT派生(0=普通に休んだ/1=道具のせいであまり休めなかった/2=勝手に自慰をし始めた)
;・ACT派生への代入は@ACTION_APPLY2_90で行われ、これを参照できるのはREACT以降(即ち、ACTでは参照はできない)
;-------------------------------------------------
;━━━━━━━━━━━━━━━━━━━━━━━━
;ACT90, 休ませる
;━━━━━━━━━━━━━━━━━━━━━━━━
IF 口上記入チェック(100)
	;RANDACTで振り分ける
	SELECTCASE RANDACT(2, 0)
		CASE 0
			;調教対象BASE:体力派生
			SELECTCASE TENSION(MASTER, 0)
				CASE "高い"
					{
					PRINTFORMW 「さて、ちょっと休むわよ。\@ TENSION(TARGET, 0) == "高い" 
                               ? お互いにまだ余裕ありそうだけど # 私、ちょっと疲れたのよね \@」
					}
					PRINTFORMW 「ま、いずれにしても…今のうちに休んでおくといいわ」
				CASE "一般"
					PRINTFORMW 「ちょっとお疲れみたいだから、少しの間休憩にするわよ」
					{
					PRINTFORMW 「\@ TENSION(TARGET, 0) == "一般" 
                               ? 私はまだまだ余裕なんだけど # そういえば、私もちょっと疲れたわね… \@」
					}
				CASE "低い"
					PRINTFORMW 「随分やつれちゃったわね……。そんなに激しくしたつもりもないんだけど。って…」
					PRINTFORMW 「%CNAME(MASTER, TARGET)%にとってはそうじゃなかったみたいね？」
					PRINTFORMW 「まぁいいわ。少しの間だけど、ゆっくりと休んで頂戴」
			ENDSELECT
		CASE 1
			IF 0
			ELSEIF AFFECTION("相思相愛") && PERCENT(80)
				PRINTFORMW 「疲れたわね。 ちょっと休みましょうか…？」
				PRINTFORM 「%CNAME(MASTER, TARGET)%には、まだ頑張ってもらわないといけないし…ね…
				CALL PRINT_SYMBOL_K14
			ELSEIF AFFECTION("溺愛") && PERCENT(70)
				PRINTFORMW 「ちょっと休みましょう」
				PRINTFORM 「あとでまた愉しませてもらうから…
				CALL PRINT_SYMBOL_K14
			ELSEIF AFFECTION("眷愛") && PERCENT(60)
				PRINTFORMW 「ちょっと休憩にしましょう」
				PRINTFORM 「終わったらまた愉しませて頂戴…
				CALL PRINT_SYMBOL_K14
			ELSEIF TRUECHECK(AFFECTION("嫌悪"), T_COND("怒り")) > 0
				PRINTFORMW 「ちょっと休むわよ…。あら、今一瞬ほっとしたわね…？」
				PRINTFORMW 「残念だけど、これで終わりじゃないから」
				PRINTFORMW 「今のうちに回復しておいた方が、身の為よ…」
			ELSE
				PRINTFORMW 「ちょっと休憩%RAND_SPLIT("ね/にするわ")%」
				PRINTFORMW 「言っとくけど、%RAND_SPLIT("まだ終わりじゃないわよ…？/これで終わりじゃないから")%」
			ENDIF
	ENDSELECT
	RETURN 2
ENDIF

;────────────────────────────────────
;ACT91, 栄養剤を飲ませる
;────────────────────────────────────
;・この時点では命令のみ
;・調教対象のリアクションが"拒否する"であった場合は"栄養剤を捨てた"に派生する
;・その他の反応の場合は"栄養剤を飲んだ"扱いになる
;・調教者にTALENT:調合知識が無い場合は発生しない(調合知識自体はSHOPでの購入が可能)
;・媚薬を使用することもある
;・TEQUIP(ボールギャグ/三角木馬)は解除される
;・顔面騎乗系、自慰系は解除される
;-------------------------------------------------
@KOJO_ACT_K14_91
;-------------------------------------------------
;・TFLAG:ACT派生(0=栄養剤を飲んだ/1=栄養剤を捨てた)
;・ACT派生への代入は@ACTION_APPLY2_91で行われ、これを参照できるのはREACT以降(即ち、ACTでは参照はできない)
;-------------------------------------------------
;KFLAGをリセット
KFLAG:TARGET:91 = 0
KFLAG:TARGET:92 = 0

IF 口上記入チェック(100) && !TEQUIP:アイマスク
	;1/2
	IF RAND:2
		SELECTCASE RANDACT(3, 10)
			CASE 0
				PRINTFORMW 「上海、例のものを持ってきて頂戴」
				PRINTFORMDW %CALLNAME%がそう言うと、\@ GET_KFLAG_K14("相思相愛") ? １体の人形 # 上海 \@が現れ、
				CALL FPRINTL(@"「\@ AFFECTION("溺愛") ? ﾊﾔｸﾉﾒﾖ # ﾊﾞｶｼﾞｬﾈｰﾉ \@」", COLOR2_K14("上海"), "RIGHT")
				PRINTFORMDW と言いながら、%CALLNAME:MASTER%に栄養剤を\@ AFFECTION("溺愛") ? 手渡した # 投げつけた \@…
				;代入しREACTで参照する
				KFLAG:TARGET:91 = 1
			CASE 1
				PRINTFORMW 「蓬莱、アレを持ってきて」
				PRINTFORMDW %CALLNAME%がそう言うと、\@ GET_KFLAG_K14("相思相愛") ? １体の人形 # 蓬莱 \@が現れ、
				CALL FPRINTL(@"「\@ AFFECTION("溺愛") ? ｻｯｻﾄﾉﾒﾖ # ﾄﾞｰﾅｯﾃﾓｼﾗﾈｰｿﾞ \@」", COLOR2_K14("上海"), "RIGHT")
				PRINTFORMDW と言いながら、%CALLNAME:MASTER%に栄養剤を\@ AFFECTION("溺愛") ? 手渡した # 投げつけた \@…
				;代入しREACTで参照する
				KFLAG:TARGET:91 = 2
			CASE 2
				{
				PRINTFORMW 「\@ GROUPMATCH(TENSION(MASTER, 0), "一般", "高い") ? ちょっとお疲れみたいね？ 上海 
				# 大分お疲れみたいね…。蓬莱 \@、アレを持ってきてくれるかしら。そう、\@ GROUPMATCH(TENSION(MASTER, 0), "一般", "高い") 
				? 普通のやつでいいわ # ちょっと強めのやつ \@」
				}
				CALL FPRINTL(@"「\@ GROUPMATCH(TENSION(MASTER, 0), "一般", "高い") ? ｼｬﾝﾊｰｲ # ﾎﾗｰｲ \@」", COLOR2_K14("上海"), "RIGHT")
				PRINTFORMDW 返事の声と共に部屋の奥から１体の人形が現れ%CALLNAME:MASTER%の足元に栄養剤を置くと、無言で立ち去っていった…
				;代入しREACTで参照する
				KFLAG:TARGET:91 = 3
				;栄養剤を飲むと数値が変動するので上海/蓬莱の判定にKFLAG:92を充てる
				KFLAG:TARGET:92 = GROUPMATCH(TENSION(MASTER, 0), "一般", "高い") ? 1 # 2
		ENDSELECT
	;1/2
	ELSE
		IF 0
		ELSEIF AFFECTION("相思相愛") && !T_COND("怒り")
			SELECTCASE RANDACT(3, 0)
				CASE 0
					PRINTFORM 「これは私の自信作よ！　もう不味いなんて言わせないんだから
					CALL PRINT_SYMBOL_K14
					PRINTFORMDW アリスは得意気な様子で%CALLNAME:MASTER%に小瓶を手渡した…
				CASE 1
					PRINTFORM 「今度こそ大丈夫！　きっと%CNAME(MASTER, TARGET)%の口に合うはずよ…？ さぁ、飲んで飲んで
					CALL PRINT_SYMBOL_K14
					PRINTFORMDW アリスは自信満々な様子で%CALLNAME:MASTER%に小瓶を手渡した…
				CASEELSE
					PRINTFORM 「これこそ私の最高傑作よ！　絶対美味しいはずだから、期待していいわよ
					CALL PRINT_SYMBOL_K14
					PRINTFORMDW アリスは熱狂的な様子で%CALLNAME:MASTER%に小瓶を手渡した…
			ENDSELECT
		ELSEIF AFFECTION("溺愛") && !T_COND("怒り")
			SELECTCASE RANDACT(3, 1)
				CASE 0
					PRINTFORM 「これは私のお手製栄養剤なの。きっと気に入るはずよ。心配しないで飲んで頂戴
				CASE 1
					PRINTFORM 「ちょっと味付けを変えてみたの。きっと気に入るはずよ。さぁ、飲んで頂戴
				CASE 2
					PRINTFORM 「ちょっと配合を変えてみたの。きっと気に入るはずよ。さぁ、試してみて頂戴
			ENDSELECT
			CALL PRINT_SYMBOL_K14
		ELSEIF AFFECTION("眷愛") && !T_COND("怒り")
			SELECTCASE RANDACT(3, 2)
				CASE 0
					PRINTFORMW 「これ友人の魔女からのお裾分けなの…　飲んでみて頂戴」
				CASE 1
					PRINTFORMW 「これ里で結構評判らしいわ。飲んでみて頂戴」
				CASE 2
					PRINTFORMW 「これ道具屋が言うには、外の世界から来たものらしいの。試してみて頂戴」
			ENDSELECT
		ELSEIF TRUECHECK(AFFECTION("嫌悪"), T_COND("怒り")) > 0
			SELECTCASE RANDACT(3, 3)
				CASE 0
					PRINTFORML 「さぁ、これを飲みなさい」 
					PRINTFORMD アリスに渡された小瓶を見ると『
					CALL SKULL2C_K14(COLOR2_K14("pink"))
					PRINTFORMDW 』のマークが張ってある…
				CASE 1
					PRINTFORML 「さぁ、これを飲んで」
					PRINTFORMDW アリスに渡された小瓶を見ると『毒』と書いてある…
				CASE 2
					PRINTFORML 「さぁ、はやく飲んで」
					PRINTFORMDW アリスに渡された小瓶を見ると『劇』と書いてある…
			 ENDSELECT
		ELSE
			PRINTFORMW 「はい、栄養剤よ。飲んで頂戴」
		ENDIF
	ENDIF
	RETURN 2
ENDIF

;────────────────────────────────────
;ACT92, 治療する
;────────────────────────────────────
;・調教者が調教対象を治療しようとする
;・REACT分類が"暴れる"であった場合は"暴れたため治療できなかった"に派生する
;・その他の場合は"体の隅々まで撫で回して治療した"という扱い
;・調教者にTALENT:治療がなければ発生しない
;・媚薬を使用することもある
;・TEQUIP:三角木馬は解除される
;・顔面騎乗系、自慰系は解除される
;-------------------------------------------------
;@KOJO_ACT_K14_92
;-------------------------------------------------
;・TFLAG:ACT派生(0=体の隅々まで撫で回して治療した/1=暴れたため治療できなかった)
;※ACT派生への代入は@ACTION_APPLY2_92で行われ、これを参照できるのはREACT以降(即ち、ACTでは参照はできない)
;-------------------------------------------------
;発生し得ないのでこのまま放置。TALENT:治療は後天素質として獲得できてもいいかも知れない
;-------------------------------------------------
;QUIT